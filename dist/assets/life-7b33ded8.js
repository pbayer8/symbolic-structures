var qr=Object.defineProperty;var Xr=(r,e,t)=>e in r?qr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Ie=(r,e,t)=>(Xr(r,typeof e!="symbol"?e+"":e,t),t);import{a as ar}from"./style-d20be366.js";import{G as Qr}from"./lil-gui.esm-b4f18ba3.js";import{S as Jr}from"./swissgl-a59cd27d.js";import{g as Zr}from"./_commonjsHelpers-edff4021.js";import{d as Ue,c as O,b as ee,r as Kr}from"./utils-5b63e897.js";let j,Fr="0.",ge=0,We=0;const Ge=new Qr;Ge.hide();const Fe=document.createElement("canvas");Fe.width=window.innerWidth;Fe.height=window.innerHeight;document.body.appendChild(Fe);const te=Jr(Fe),et=r=>Fr=r;function Er(r){We=r/1e3-ge,ge=r/1e3,requestAnimationFrame(Er),j&&te({field:j,FP:Fr}),X.instances.forEach(t=>t.frame());const e=Object.fromEntries(X.instances.filter(t=>t.shareField).map(t=>[`field_${t.name}`,t.field[0]]));j=te({Clear:[0,0,0,0],...e,FP:Object.keys(e).map(t=>`${t}(UV)`).join("+")},{format:"rgba32f",tag:"field"})}requestAnimationFrame(Er);const q={ADD:"s+d",SUBTRACT:"d-s",TRANSPARENT:"d*(1-sa)+s*sa",PREMULTIPLIED:"d*(1-sa)+s",MAX:"max(s,d)",MIN:"min(s,d)",MULTIPLY:"d*s",REPLACE:"s"},R={RANDOM_WORLD:"hash(ivec3(I, seed)).xy * worldSize",RANDOM_ANGLE:"vec2(hash(ivec3(I, seed)).x * TAU,1.0)",RANDOM_RANGE:"hash(ivec3(I, seed)).xy * 2. - 1.",RANDOM_UNIT:"normalize(hash(ivec3(I, seed)).xy * 2. - 1.)",RANDOM:"hash(ivec3(I, seed)).xy",RANDOM2:"hash(ivec3(seed, I*2)).xy",DOT_GRID:r=>`fract(vec2(I) / ${r}.0) * worldSize`,CIRCLE:r=>`vec2(cos(hash(ivec3(I, seed)).x * TAU), sin(hash(ivec3(I, seed)).x * TAU)) * ${r} * max(worldSize.x,worldSize.y) - worldSize/2.`,VERTICLE_LINE:"vec2(worldSize.x/2., hash(ivec3(I, seed)).x * worldSize.y)",HORIZONTAL_LINE:"vec2(hash(ivec3(I, seed)).x * worldSize.x, worldSize.y/2.)",VERTICLE_LINES:r=>`vec2(
      fract(vec2(I).x / ${r}.0) * worldSize.x, 
      fract(hash(ivec3(I, seed)).y * ${r}.0) * worldSize.y
    )`,HORIZONTAL_LINES:r=>`vec2(
      fract(hash(ivec3(I, seed)).x * ${r}.0) * worldSize.x, 
      fract(vec2(I).y / ${r}.0) * worldSize.y
    )`,ZERO:"vec2(0.)",CONST:(r,e)=>`vec2(${r}, ${e})`,VERTICLE_LINE_AT:r=>`vec2(${r}*worldSize.x, hash(ivec3(I, seed)).x * worldSize.y)`,HORIZONTAL_LINE_AT:r=>`vec2(hash(ivec3(I, seed)).x * worldSize.x, ${r}*worldSize.y)`,SIN:(r,e)=>`vec2(hash(ivec3(I, seed)).x * worldSize.x,   sin(hash(ivec3(I, seed)).x * TAU / ${r}) * ${e} * worldSize.y + worldSize.y/2.)`},Y=class{constructor({name:e="",debug:t=!1,particleCount:n=1024,particleSize:a=1,shareField:i=!0,readOtherFields:l=!1,readOtherParticles:o=!1,renderParticles:c="mix(vec4(0.), particleColor, smoothstep(1.0, 0.0, length(XY)))",particleColor:s=[1,1,1,1],renderField:f="mix(vec4(0.), fieldColor, length(field(UV))/2.)",fieldColor:h=[1,1,1,1],writeField:u="smoothstep(1.0, 0.0, length(XY))",writeFieldBlend:v=q.ADD,renderFieldBlend:d=q.ADD,renderParticlesBlend:A=q.PREMULTIPLIED,updateFieldDecay:F=.95,updateFieldBlur:y=1,updateFieldSteps:E=1,updateField:N=`vec2 dp = Src_step()*updateFieldBlur;
    float x=UV.x, y=UV.y;
    float l=x-dp.x, r=x+dp.x, u=y-dp.y, d=y+dp.y;
    #define S(x,y) (Src(vec2(x,y)))
    // Apply a 3x3 mean filter and decay factor to the field
    FOut = updateFieldDecay*(S(x,y)+S(l,y)+S(r,y)+S(x,u)+S(x,d)+S(l,u)+S(r,u)+S(l,d)+S(r,d))/9.0;`,initialParticlesXY:_=R.RANDOM_WORLD,initialParticlesZW:V=R.RANDOM_ANGLE,initialField:Z="0.",updateParticles:T="",uniforms:$={},numSteps:B=1,numStorysParticles:L=2,wrapParticles:k=!0,mouseStrength:x=.1,mouseRadius:I=.25}={}){this.instances=Y.instances,this.index=Y.instances.length,this.debug=t,this.name=e||this.index,this.uniforms=$;const m=(D,P,Ee=this)=>{Ee[D]=P,t&&(typeof P=="number"?this.gui.add(Ee,D,-1*P,8*P):Array.isArray(P)&&this.gui.addColor(Ee,D))};t&&(this.gui=Ge.addFolder(this.name),this.gui.add(this,"uniformsToClipboard"),this.gui.add(this,"reset"),Ge.show()),m("particleCount",n),m("particleSize",a),m("numSteps",B),m("updateFieldDecay",F),m("updateFieldBlur",y),m("updateFieldSteps",E),m("particleColor",s),m("fieldColor",h),m("mouseStrength",x),m("mouseRadius",I),Object.entries(this.uniforms).forEach(([D,P])=>m(D,P,this.uniforms)),this.renderParticles=c,this.renderField=f,this.writeField=u,this.readOtherFields=l,this.readOtherParticles=o,this.wrapParticles=k,this.initialParticlesXY=_,this.initialParticlesZW=V,this.initialField=Z,this.updateParticles=T,this.renderParticlesBlend=A,this.renderFieldBlend=d,this.numStorysParticles=L,this.writeFieldBlend=v,this.updateField=N,this.shareField=i,this.seed=Math.floor(Math.random()*1e3),this.standardParticlesVP=`
      particle = particles(ID.xy);
      VOut.xy = 2.0 * (particles(ID.xy).xy+XY*particleSize)/vec2(ViewSize) - 1.0;`,this.reset(),Y.instances.push(this)}uniformsToClipboard(){const e=JSON.stringify({particleCount:this.particleCount,particleSize:this.particleSize,numSteps:this.numSteps,updateFieldDecay:this.updateFieldDecay,updateFieldBlur:this.updateFieldBlur,updateFieldSteps:this.updateFieldSteps,uniforms:this.uniforms});navigator.clipboard.writeText(e)}frame(){for(let e=0;e<this.numSteps;e++)this.step(te);this.render(te)}render(e){e({fieldColor:this.fieldColor,Blend:this.renderFieldBlend,field:this.field[0],FP:this.renderField,...this.uniforms}),e({particleColor:this.particleColor,Blend:this.renderParticlesBlend,particles:this.particles[0],Grid:this.particles[0].size,particleSize:this.particleSize,Inc:"varying vec4 particle;",VP:this.standardParticlesVP,FP:this.renderParticles})}reset(){this.field=te({FP:this.initialField},{story:2,format:"rgba32f",tag:`field_${this.name}`});for(let e=0;e<this.numStorysParticles;e++)this.particles=te({seed:this.seed,field:this.shareField&&j?j:this.field[0],FP:`vec2 worldSize = vec2(field_size());
          FOut = vec4(${this.initialParticlesXY}, ${this.initialParticlesZW});`},{size:Array(2).fill(Math.ceil(Math.sqrt(this.particleCount))),story:this.numStorysParticles,format:"rgba32f",tag:`particles_${this.name}`})}step(e){for(let t=0;t<this.updateFieldSteps;t++)e({updateFieldDecay:Math.pow(this.updateFieldDecay,1/this.updateFieldSteps),updateFieldBlur:this.updateFieldBlur,FP:this.updateField},this.field);e({...this.uniforms,mouse:ar,time:ge,timeDelta:We,mouseStrength:this.mouseStrength,mouseRadius:this.mouseRadius,...this.numStorysParticles>2?{past:this.particles[1]}:{},seed:this.seed,field:this.shareField&&j?j:this.field[0],...this.readOtherFields?Object.fromEntries(Y.instances.filter(t=>t.field).map(t=>[`field_${t.name}`,t.field[0]])):{},...this.readOtherParticles?Object.fromEntries(Y.instances.filter(t=>t.particles).map(t=>[`particles_${t.name}`,t.particles[0]])):{},FP:`FOut = Src(I);
      vec2 worldSize = vec2(field_size());
      ${typeof this.updateParticles=="function"?this.updateParticles():this.updateParticles}
      vec2 mousePos = mouse.xy;
      float aspectRatio = worldSize.x/worldSize.y;
      vec2 aspectMult = aspectRatio > 1. ? vec2(aspectRatio, 1.) : vec2(1., 1./aspectRatio);
      float mouseDist = length(mousePos*worldSize - FOut.xy);
      mouseDist = min(mouseDist, length((mousePos+worldSize)*worldSize - FOut.xy));
      mouseDist = min(mouseDist, length((mousePos-worldSize)*worldSize - FOut.xy));
      float strength = mouse.z * smoothstep(mouseRadius, 0., mouseDist/max(worldSize.x, worldSize.y));
      FOut.xy += mouseStrength * strength * (mousePos*worldSize - FOut.xy);
      ${this.wrapParticles?"FOut.xy = mod(FOut.xy, worldSize);":""}`},this.particles),e({...this.uniforms,mouse:ar,time:ge,timeDelta:We,seed:this.seed,mouseStrength:this.mouseStrength,particles:this.particles[0],Grid:this.particles[0].size,particleSize:this.particleSize,Blend:this.writeFieldBlend,Inc:"varying vec4 particle;",VP:this.standardParticlesVP,FP:this.writeField},this.field[0])}};let X=Y;Ie(X,"instances",[]);var rt=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;e[t]=a;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(e,t);if(l.value!==a||l.enumerable!==!0)return!1}return!0},or=typeof Symbol<"u"&&Symbol,tt=rt,nt=function(){return typeof or!="function"||typeof Symbol!="function"||typeof or("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:tt()},lr={foo:{}},it=Object,at=function(){return{__proto__:lr}.foo===lr.foo&&!({__proto__:null}instanceof it)},ot="Function.prototype.bind called on incompatible ",Re=Array.prototype.slice,lt=Object.prototype.toString,ct="[object Function]",st=function(e){var t=this;if(typeof t!="function"||lt.call(t)!==ct)throw new TypeError(ot+t);for(var n=Re.call(arguments,1),a,i=function(){if(this instanceof a){var f=t.apply(this,n.concat(Re.call(arguments)));return Object(f)===f?f:this}else return t.apply(e,n.concat(Re.call(arguments)))},l=Math.max(0,t.length-n.length),o=[],c=0;c<l;c++)o.push("$"+c);if(a=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this,arguments); }")(i),t.prototype){var s=function(){};s.prototype=t.prototype,a.prototype=new s,s.prototype=null}return a},ft=st,Je=Function.prototype.bind||ft,ut=Je,pt=ut.call(Function.call,Object.prototype.hasOwnProperty),p,ie=SyntaxError,Ir=Function,ne=TypeError,Ne=function(r){try{return Ir('"use strict"; return ('+r+").constructor;")()}catch{}},Q=Object.getOwnPropertyDescriptor;if(Q)try{Q({},"")}catch{Q=null}var $e=function(){throw new ne},yt=Q?function(){try{return arguments.callee,$e}catch{try{return Q(arguments,"callee").get}catch{return $e}}}():$e,K=nt(),dt=at(),S=Object.getPrototypeOf||(dt?function(r){return r.__proto__}:null),re={},ht=typeof Uint8Array>"u"||!S?p:S(Uint8Array),J={"%AggregateError%":typeof AggregateError>"u"?p:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?p:ArrayBuffer,"%ArrayIteratorPrototype%":K&&S?S([][Symbol.iterator]()):p,"%AsyncFromSyncIteratorPrototype%":p,"%AsyncFunction%":re,"%AsyncGenerator%":re,"%AsyncGeneratorFunction%":re,"%AsyncIteratorPrototype%":re,"%Atomics%":typeof Atomics>"u"?p:Atomics,"%BigInt%":typeof BigInt>"u"?p:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?p:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?p:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?p:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?p:Float32Array,"%Float64Array%":typeof Float64Array>"u"?p:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?p:FinalizationRegistry,"%Function%":Ir,"%GeneratorFunction%":re,"%Int8Array%":typeof Int8Array>"u"?p:Int8Array,"%Int16Array%":typeof Int16Array>"u"?p:Int16Array,"%Int32Array%":typeof Int32Array>"u"?p:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":K&&S?S(S([][Symbol.iterator]())):p,"%JSON%":typeof JSON=="object"?JSON:p,"%Map%":typeof Map>"u"?p:Map,"%MapIteratorPrototype%":typeof Map>"u"||!K||!S?p:S(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?p:Promise,"%Proxy%":typeof Proxy>"u"?p:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?p:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?p:Set,"%SetIteratorPrototype%":typeof Set>"u"||!K||!S?p:S(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?p:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":K&&S?S(""[Symbol.iterator]()):p,"%Symbol%":K?Symbol:p,"%SyntaxError%":ie,"%ThrowTypeError%":yt,"%TypedArray%":ht,"%TypeError%":ne,"%Uint8Array%":typeof Uint8Array>"u"?p:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?p:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?p:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?p:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?p:WeakMap,"%WeakRef%":typeof WeakRef>"u"?p:WeakRef,"%WeakSet%":typeof WeakSet>"u"?p:WeakSet};if(S)try{null.error}catch(r){var vt=S(S(r));J["%Error.prototype%"]=vt}var mt=function r(e){var t;if(e==="%AsyncFunction%")t=Ne("async function () {}");else if(e==="%GeneratorFunction%")t=Ne("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=Ne("async function* () {}");else if(e==="%AsyncGenerator%"){var n=r("%AsyncGeneratorFunction%");n&&(t=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var a=r("%AsyncGenerator%");a&&S&&(t=S(a.prototype))}return J[e]=t,t},cr={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},pe=Je,Se=pt,gt=pe.call(Function.call,Array.prototype.concat),St=pe.call(Function.apply,Array.prototype.splice),sr=pe.call(Function.call,String.prototype.replace),Oe=pe.call(Function.call,String.prototype.slice),Ot=pe.call(Function.call,RegExp.prototype.exec),At=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,wt=/\\(\\)?/g,bt=function(e){var t=Oe(e,0,1),n=Oe(e,-1);if(t==="%"&&n!=="%")throw new ie("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&t!=="%")throw new ie("invalid intrinsic syntax, expected opening `%`");var a=[];return sr(e,At,function(i,l,o,c){a[a.length]=o?sr(c,wt,"$1"):l||i}),a},Pt=function(e,t){var n=e,a;if(Se(cr,n)&&(a=cr[n],n="%"+a[0]+"%"),Se(J,n)){var i=J[n];if(i===re&&(i=mt(n)),typeof i>"u"&&!t)throw new ne("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:a,name:n,value:i}}throw new ie("intrinsic "+e+" does not exist!")},Ze=function(e,t){if(typeof e!="string"||e.length===0)throw new ne("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new ne('"allowMissing" argument must be a boolean');if(Ot(/^%?[^%]*%?$/,e)===null)throw new ie("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=bt(e),a=n.length>0?n[0]:"",i=Pt("%"+a+"%",t),l=i.name,o=i.value,c=!1,s=i.alias;s&&(a=s[0],St(n,gt([0,1],s)));for(var f=1,h=!0;f<n.length;f+=1){var u=n[f],v=Oe(u,0,1),d=Oe(u,-1);if((v==='"'||v==="'"||v==="`"||d==='"'||d==="'"||d==="`")&&v!==d)throw new ie("property names with quotes must have matching quotes");if((u==="constructor"||!h)&&(c=!0),a+="."+u,l="%"+a+"%",Se(J,l))o=J[l];else if(o!=null){if(!(u in o)){if(!t)throw new ne("base intrinsic for "+e+" exists, but the property is not available.");return}if(Q&&f+1>=n.length){var A=Q(o,u);h=!!A,h&&"get"in A&&!("originalValue"in A.get)?o=A.get:o=o[u]}else h=Se(o,u),o=o[u];h&&!c&&(J[l]=o)}}return o},Ve={},xt={get exports(){return Ve},set exports(r){Ve=r}};(function(r){var e=Je,t=Ze,n=t("%Function.prototype.apply%"),a=t("%Function.prototype.call%"),i=t("%Reflect.apply%",!0)||e.call(a,n),l=t("%Object.getOwnPropertyDescriptor%",!0),o=t("%Object.defineProperty%",!0),c=t("%Math.max%");if(o)try{o({},"a",{value:1})}catch{o=null}r.exports=function(h){var u=i(e,a,arguments);if(l&&o){var v=l(u,"length");v.configurable&&o(u,"length",{value:1+c(0,h.length-(arguments.length-1))})}return u};var s=function(){return i(e,n,arguments)};o?o(r.exports,"apply",{value:s}):r.exports.apply=s})(xt);var Rr=Ze,Nr=Ve,Ft=Nr(Rr("String.prototype.indexOf")),Et=function(e,t){var n=Rr(e,!!t);return typeof n=="function"&&Ft(e,".prototype.")>-1?Nr(n):n};const It={},Rt=Object.freeze(Object.defineProperty({__proto__:null,default:It},Symbol.toStringTag,{value:"Module"})),Nt=Zr(Rt);var Ke=typeof Map=="function"&&Map.prototype,De=Object.getOwnPropertyDescriptor&&Ke?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ae=Ke&&De&&typeof De.get=="function"?De.get:null,fr=Ke&&Map.prototype.forEach,er=typeof Set=="function"&&Set.prototype,Me=Object.getOwnPropertyDescriptor&&er?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,we=er&&Me&&typeof Me.get=="function"?Me.get:null,ur=er&&Set.prototype.forEach,$t=typeof WeakMap=="function"&&WeakMap.prototype,se=$t?WeakMap.prototype.has:null,Dt=typeof WeakSet=="function"&&WeakSet.prototype,fe=Dt?WeakSet.prototype.has:null,Mt=typeof WeakRef=="function"&&WeakRef.prototype,pr=Mt?WeakRef.prototype.deref:null,Ct=Boolean.prototype.valueOf,Tt=Object.prototype.toString,zt=Function.prototype.toString,_t=String.prototype.match,rr=String.prototype.slice,W=String.prototype.replace,Bt=String.prototype.toUpperCase,yr=String.prototype.toLowerCase,$r=RegExp.prototype.test,dr=Array.prototype.concat,C=Array.prototype.join,Lt=Array.prototype.slice,hr=Math.floor,ke=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Ce=Object.getOwnPropertySymbols,He=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,ae=typeof Symbol=="function"&&typeof Symbol.iterator=="object",b=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===ae||"symbol")?Symbol.toStringTag:null,Dr=Object.prototype.propertyIsEnumerable,vr=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function mr(r,e){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||$r.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var n=r<0?-hr(-r):hr(r);if(n!==r){var a=String(n),i=rr.call(e,a.length+1);return W.call(a,t,"$&_")+"."+W.call(W.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return W.call(e,t,"$&_")}var Ye=Nt,gr=Ye.custom,Sr=Cr(gr)?gr:null,Ut=function r(e,t,n,a){var i=t||{};if(U(i,"quoteStyle")&&i.quoteStyle!=="single"&&i.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(U(i,"maxStringLength")&&(typeof i.maxStringLength=="number"?i.maxStringLength<0&&i.maxStringLength!==1/0:i.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var l=U(i,"customInspect")?i.customInspect:!0;if(typeof l!="boolean"&&l!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(U(i,"indent")&&i.indent!==null&&i.indent!=="	"&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(U(i,"numericSeparator")&&typeof i.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=i.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return zr(e,i);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return o?mr(e,c):c}if(typeof e=="bigint"){var s=String(e)+"n";return o?mr(e,s):s}var f=typeof i.depth>"u"?5:i.depth;if(typeof n>"u"&&(n=0),n>=f&&f>0&&typeof e=="object")return je(e)?"[Array]":"[Object]";var h=an(i,n);if(typeof a>"u")a=[];else if(Tr(a,e)>=0)return"[Circular]";function u(I,m,D){if(m&&(a=Lt.call(a),a.push(m)),D){var P={depth:i.depth};return U(i,"quoteStyle")&&(P.quoteStyle=i.quoteStyle),r(I,P,n+1,a)}return r(I,i,n+1,a)}if(typeof e=="function"&&!Or(e)){var v=Xt(e),d=ye(e,u);return"[Function"+(v?": "+v:" (anonymous)")+"]"+(d.length>0?" { "+C.call(d,", ")+" }":"")}if(Cr(e)){var A=ae?W.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):He.call(e);return typeof e=="object"&&!ae?ce(A):A}if(rn(e)){for(var F="<"+yr.call(String(e.nodeName)),y=e.attributes||[],E=0;E<y.length;E++)F+=" "+y[E].name+"="+Mr(Wt(y[E].value),"double",i);return F+=">",e.childNodes&&e.childNodes.length&&(F+="..."),F+="</"+yr.call(String(e.nodeName))+">",F}if(je(e)){if(e.length===0)return"[]";var N=ye(e,u);return h&&!nn(N)?"["+qe(N,h)+"]":"[ "+C.call(N,", ")+" ]"}if(Vt(e)){var _=ye(e,u);return!("cause"in Error.prototype)&&"cause"in e&&!Dr.call(e,"cause")?"{ ["+String(e)+"] "+C.call(dr.call("[cause]: "+u(e.cause),_),", ")+" }":_.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+C.call(_,", ")+" }"}if(typeof e=="object"&&l){if(Sr&&typeof e[Sr]=="function"&&Ye)return Ye(e,{depth:f-n});if(l!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Qt(e)){var V=[];return fr&&fr.call(e,function(I,m){V.push(u(m,e,!0)+" => "+u(I,e))}),Ar("Map",Ae.call(e),V,h)}if(Kt(e)){var Z=[];return ur&&ur.call(e,function(I){Z.push(u(I,e))}),Ar("Set",we.call(e),Z,h)}if(Jt(e))return Te("WeakMap");if(en(e))return Te("WeakSet");if(Zt(e))return Te("WeakRef");if(Ht(e))return ce(u(Number(e)));if(jt(e))return ce(u(ke.call(e)));if(Yt(e))return ce(Ct.call(e));if(kt(e))return ce(u(String(e)));if(!Gt(e)&&!Or(e)){var T=ye(e,u),$=vr?vr(e)===Object.prototype:e instanceof Object||e.constructor===Object,B=e instanceof Object?"":"null prototype",L=!$&&b&&Object(e)===e&&b in e?rr.call(G(e),8,-1):B?"Object":"",k=$||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",x=k+(L||B?"["+C.call(dr.call([],L||[],B||[]),": ")+"] ":"");return T.length===0?x+"{}":h?x+"{"+qe(T,h)+"}":x+"{ "+C.call(T,", ")+" }"}return String(e)};function Mr(r,e,t){var n=(t.quoteStyle||e)==="double"?'"':"'";return n+r+n}function Wt(r){return W.call(String(r),/"/g,"&quot;")}function je(r){return G(r)==="[object Array]"&&(!b||!(typeof r=="object"&&b in r))}function Gt(r){return G(r)==="[object Date]"&&(!b||!(typeof r=="object"&&b in r))}function Or(r){return G(r)==="[object RegExp]"&&(!b||!(typeof r=="object"&&b in r))}function Vt(r){return G(r)==="[object Error]"&&(!b||!(typeof r=="object"&&b in r))}function kt(r){return G(r)==="[object String]"&&(!b||!(typeof r=="object"&&b in r))}function Ht(r){return G(r)==="[object Number]"&&(!b||!(typeof r=="object"&&b in r))}function Yt(r){return G(r)==="[object Boolean]"&&(!b||!(typeof r=="object"&&b in r))}function Cr(r){if(ae)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!He)return!1;try{return He.call(r),!0}catch{}return!1}function jt(r){if(!r||typeof r!="object"||!ke)return!1;try{return ke.call(r),!0}catch{}return!1}var qt=Object.prototype.hasOwnProperty||function(r){return r in this};function U(r,e){return qt.call(r,e)}function G(r){return Tt.call(r)}function Xt(r){if(r.name)return r.name;var e=_t.call(zt.call(r),/^function\s*([\w$]+)/);return e?e[1]:null}function Tr(r,e){if(r.indexOf)return r.indexOf(e);for(var t=0,n=r.length;t<n;t++)if(r[t]===e)return t;return-1}function Qt(r){if(!Ae||!r||typeof r!="object")return!1;try{Ae.call(r);try{we.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function Jt(r){if(!se||!r||typeof r!="object")return!1;try{se.call(r,se);try{fe.call(r,fe)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function Zt(r){if(!pr||!r||typeof r!="object")return!1;try{return pr.call(r),!0}catch{}return!1}function Kt(r){if(!we||!r||typeof r!="object")return!1;try{we.call(r);try{Ae.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function en(r){if(!fe||!r||typeof r!="object")return!1;try{fe.call(r,fe);try{se.call(r,se)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function rn(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function zr(r,e){if(r.length>e.maxStringLength){var t=r.length-e.maxStringLength,n="... "+t+" more character"+(t>1?"s":"");return zr(rr.call(r,0,e.maxStringLength),e)+n}var a=W.call(W.call(r,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,tn);return Mr(a,"single",e)}function tn(r){var e=r.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+Bt.call(e.toString(16))}function ce(r){return"Object("+r+")"}function Te(r){return r+" { ? }"}function Ar(r,e,t,n){var a=n?qe(t,n):C.call(t,", ");return r+" ("+e+") {"+a+"}"}function nn(r){for(var e=0;e<r.length;e++)if(Tr(r[e],`
`)>=0)return!1;return!0}function an(r,e){var t;if(r.indent==="	")t="	";else if(typeof r.indent=="number"&&r.indent>0)t=C.call(Array(r.indent+1)," ");else return null;return{base:t,prev:C.call(Array(e+1),t)}}function qe(r,e){if(r.length===0)return"";var t=`
`+e.prev+e.base;return t+C.call(r,","+t)+`
`+e.prev}function ye(r,e){var t=je(r),n=[];if(t){n.length=r.length;for(var a=0;a<r.length;a++)n[a]=U(r,a)?e(r[a],r):""}var i=typeof Ce=="function"?Ce(r):[],l;if(ae){l={};for(var o=0;o<i.length;o++)l["$"+i[o]]=i[o]}for(var c in r)U(r,c)&&(t&&String(Number(c))===c&&c<r.length||ae&&l["$"+c]instanceof Symbol||($r.call(/[^\w$]/,c)?n.push(e(c,r)+": "+e(r[c],r)):n.push(c+": "+e(r[c],r))));if(typeof Ce=="function")for(var s=0;s<i.length;s++)Dr.call(r,i[s])&&n.push("["+e(i[s])+"]: "+e(r[i[s]],r));return n}var tr=Ze,le=Et,on=Ut,ln=tr("%TypeError%"),de=tr("%WeakMap%",!0),he=tr("%Map%",!0),cn=le("WeakMap.prototype.get",!0),sn=le("WeakMap.prototype.set",!0),fn=le("WeakMap.prototype.has",!0),un=le("Map.prototype.get",!0),pn=le("Map.prototype.set",!0),yn=le("Map.prototype.has",!0),nr=function(r,e){for(var t=r,n;(n=t.next)!==null;t=n)if(n.key===e)return t.next=n.next,n.next=r.next,r.next=n,n},dn=function(r,e){var t=nr(r,e);return t&&t.value},hn=function(r,e,t){var n=nr(r,e);n?n.value=t:r.next={key:e,next:r.next,value:t}},vn=function(r,e){return!!nr(r,e)},mn=function(){var e,t,n,a={assert:function(i){if(!a.has(i))throw new ln("Side channel does not contain "+on(i))},get:function(i){if(de&&i&&(typeof i=="object"||typeof i=="function")){if(e)return cn(e,i)}else if(he){if(t)return un(t,i)}else if(n)return dn(n,i)},has:function(i){if(de&&i&&(typeof i=="object"||typeof i=="function")){if(e)return fn(e,i)}else if(he){if(t)return yn(t,i)}else if(n)return vn(n,i);return!1},set:function(i,l){de&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new de),sn(e,i,l)):he?(t||(t=new he),pn(t,i,l)):(n||(n={key:{},next:null}),hn(n,i,l))}};return a},gn=String.prototype.replace,Sn=/%20/g,ze={RFC1738:"RFC1738",RFC3986:"RFC3986"},ir={default:ze.RFC3986,formatters:{RFC1738:function(r){return gn.call(r,Sn,"+")},RFC3986:function(r){return String(r)}},RFC1738:ze.RFC1738,RFC3986:ze.RFC3986},On=ir,_e=Object.prototype.hasOwnProperty,H=Array.isArray,M=function(){for(var r=[],e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r}(),An=function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(H(n)){for(var a=[],i=0;i<n.length;++i)typeof n[i]<"u"&&a.push(n[i]);t.obj[t.prop]=a}}},_r=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},a=0;a<e.length;++a)typeof e[a]<"u"&&(n[a]=e[a]);return n},wn=function r(e,t,n){if(!t)return e;if(typeof t!="object"){if(H(e))e.push(t);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!_e.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var a=e;return H(e)&&!H(t)&&(a=_r(e,n)),H(e)&&H(t)?(t.forEach(function(i,l){if(_e.call(e,l)){var o=e[l];o&&typeof o=="object"&&i&&typeof i=="object"?e[l]=r(o,i,n):e.push(i)}else e[l]=i}),e):Object.keys(t).reduce(function(i,l){var o=t[l];return _e.call(i,l)?i[l]=r(i[l],o,n):i[l]=o,i},a)},bn=function(e,t){return Object.keys(t).reduce(function(n,a){return n[a]=t[a],n},e)},Pn=function(r,e,t){var n=r.replace(/\+/g," ");if(t==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},xn=function(e,t,n,a,i){if(e.length===0)return e;var l=e;if(typeof e=="symbol"?l=Symbol.prototype.toString.call(e):typeof e!="string"&&(l=String(e)),n==="iso-8859-1")return escape(l).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var o="",c=0;c<l.length;++c){var s=l.charCodeAt(c);if(s===45||s===46||s===95||s===126||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122||i===On.RFC1738&&(s===40||s===41)){o+=l.charAt(c);continue}if(s<128){o=o+M[s];continue}if(s<2048){o=o+(M[192|s>>6]+M[128|s&63]);continue}if(s<55296||s>=57344){o=o+(M[224|s>>12]+M[128|s>>6&63]+M[128|s&63]);continue}c+=1,s=65536+((s&1023)<<10|l.charCodeAt(c)&1023),o+=M[240|s>>18]+M[128|s>>12&63]+M[128|s>>6&63]+M[128|s&63]}return o},Fn=function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],a=0;a<t.length;++a)for(var i=t[a],l=i.obj[i.prop],o=Object.keys(l),c=0;c<o.length;++c){var s=o[c],f=l[s];typeof f=="object"&&f!==null&&n.indexOf(f)===-1&&(t.push({obj:l,prop:s}),n.push(f))}return An(t),e},En=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},In=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},Rn=function(e,t){return[].concat(e,t)},Nn=function(e,t){if(H(e)){for(var n=[],a=0;a<e.length;a+=1)n.push(t(e[a]));return n}return t(e)},Br={arrayToObject:_r,assign:bn,combine:Rn,compact:Fn,decode:Pn,encode:xn,isBuffer:In,isRegExp:En,maybeMap:Nn,merge:wn},Lr=mn,ve=Br,ue=ir,$n=Object.prototype.hasOwnProperty,wr={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},z=Array.isArray,Dn=Array.prototype.push,Ur=function(r,e){Dn.apply(r,z(e)?e:[e])},Mn=Date.prototype.toISOString,br=ue.default,w={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:ve.encode,encodeValuesOnly:!1,format:br,formatter:ue.formatters[br],indices:!1,serializeDate:function(e){return Mn.call(e)},skipNulls:!1,strictNullHandling:!1},Cn=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Be={},Tn=function r(e,t,n,a,i,l,o,c,s,f,h,u,v,d,A,F){for(var y=e,E=F,N=0,_=!1;(E=E.get(Be))!==void 0&&!_;){var V=E.get(e);if(N+=1,typeof V<"u"){if(V===N)throw new RangeError("Cyclic object value");_=!0}typeof E.get(Be)>"u"&&(N=0)}if(typeof c=="function"?y=c(t,y):y instanceof Date?y=h(y):n==="comma"&&z(y)&&(y=ve.maybeMap(y,function(P){return P instanceof Date?h(P):P})),y===null){if(i)return o&&!d?o(t,w.encoder,A,"key",u):t;y=""}if(Cn(y)||ve.isBuffer(y)){if(o){var Z=d?t:o(t,w.encoder,A,"key",u);return[v(Z)+"="+v(o(y,w.encoder,A,"value",u))]}return[v(t)+"="+v(String(y))]}var T=[];if(typeof y>"u")return T;var $;if(n==="comma"&&z(y))d&&o&&(y=ve.maybeMap(y,o)),$=[{value:y.length>0?y.join(",")||null:void 0}];else if(z(c))$=c;else{var B=Object.keys(y);$=s?B.sort(s):B}for(var L=a&&z(y)&&y.length===1?t+"[]":t,k=0;k<$.length;++k){var x=$[k],I=typeof x=="object"&&typeof x.value<"u"?x.value:y[x];if(!(l&&I===null)){var m=z(y)?typeof n=="function"?n(L,x):L:L+(f?"."+x:"["+x+"]");F.set(e,N);var D=Lr();D.set(Be,F),Ur(T,r(I,m,n,a,i,l,n==="comma"&&d&&z(y)?null:o,c,s,f,h,u,v,d,A,D))}}return T},zn=function(e){if(!e)return w;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||w.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=ue.default;if(typeof e.format<"u"){if(!$n.call(ue.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var a=ue.formatters[n],i=w.filter;return(typeof e.filter=="function"||z(e.filter))&&(i=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:w.addQueryPrefix,allowDots:typeof e.allowDots>"u"?w.allowDots:!!e.allowDots,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:w.charsetSentinel,delimiter:typeof e.delimiter>"u"?w.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:w.encode,encoder:typeof e.encoder=="function"?e.encoder:w.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:w.encodeValuesOnly,filter:i,format:n,formatter:a,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:w.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:w.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:w.strictNullHandling}},_n=function(r,e){var t=r,n=zn(e),a,i;typeof n.filter=="function"?(i=n.filter,t=i("",t)):z(n.filter)&&(i=n.filter,a=i);var l=[];if(typeof t!="object"||t===null)return"";var o;e&&e.arrayFormat in wr?o=e.arrayFormat:e&&"indices"in e?o=e.indices?"indices":"repeat":o="indices";var c=wr[o];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var s=c==="comma"&&e&&e.commaRoundTrip;a||(a=Object.keys(t)),n.sort&&a.sort(n.sort);for(var f=Lr(),h=0;h<a.length;++h){var u=a[h];n.skipNulls&&t[u]===null||Ur(l,Tn(t[u],u,c,s,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,f))}var v=l.join(n.delimiter),d=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),v.length>0?d+v:""},oe=Br,Xe=Object.prototype.hasOwnProperty,Bn=Array.isArray,g={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:oe.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ln=function(r){return r.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},Wr=function(r,e){return r&&typeof r=="string"&&e.comma&&r.indexOf(",")>-1?r.split(","):r},Un="utf8=%26%2310003%3B",Wn="utf8=%E2%9C%93",Gn=function(e,t){var n={__proto__:null},a=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,l=a.split(t.delimiter,i),o=-1,c,s=t.charset;if(t.charsetSentinel)for(c=0;c<l.length;++c)l[c].indexOf("utf8=")===0&&(l[c]===Wn?s="utf-8":l[c]===Un&&(s="iso-8859-1"),o=c,c=l.length);for(c=0;c<l.length;++c)if(c!==o){var f=l[c],h=f.indexOf("]="),u=h===-1?f.indexOf("="):h+1,v,d;u===-1?(v=t.decoder(f,g.decoder,s,"key"),d=t.strictNullHandling?null:""):(v=t.decoder(f.slice(0,u),g.decoder,s,"key"),d=oe.maybeMap(Wr(f.slice(u+1),t),function(A){return t.decoder(A,g.decoder,s,"value")})),d&&t.interpretNumericEntities&&s==="iso-8859-1"&&(d=Ln(d)),f.indexOf("[]=")>-1&&(d=Bn(d)?[d]:d),Xe.call(n,v)?n[v]=oe.combine(n[v],d):n[v]=d}return n},Vn=function(r,e,t,n){for(var a=n?e:Wr(e,t),i=r.length-1;i>=0;--i){var l,o=r[i];if(o==="[]"&&t.parseArrays)l=[].concat(a);else{l=t.plainObjects?Object.create(null):{};var c=o.charAt(0)==="["&&o.charAt(o.length-1)==="]"?o.slice(1,-1):o,s=parseInt(c,10);!t.parseArrays&&c===""?l={0:a}:!isNaN(s)&&o!==c&&String(s)===c&&s>=0&&t.parseArrays&&s<=t.arrayLimit?(l=[],l[s]=a):c!=="__proto__"&&(l[c]=a)}a=l}return a},kn=function(e,t,n,a){if(e){var i=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,l=/(\[[^[\]]*])/,o=/(\[[^[\]]*])/g,c=n.depth>0&&l.exec(i),s=c?i.slice(0,c.index):i,f=[];if(s){if(!n.plainObjects&&Xe.call(Object.prototype,s)&&!n.allowPrototypes)return;f.push(s)}for(var h=0;n.depth>0&&(c=o.exec(i))!==null&&h<n.depth;){if(h+=1,!n.plainObjects&&Xe.call(Object.prototype,c[1].slice(1,-1))&&!n.allowPrototypes)return;f.push(c[1])}return c&&f.push("["+i.slice(c.index)+"]"),Vn(f,t,n,a)}},Hn=function(e){if(!e)return g;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?g.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?g.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:g.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:g.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:g.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:g.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:g.comma,decoder:typeof e.decoder=="function"?e.decoder:g.decoder,delimiter:typeof e.delimiter=="string"||oe.isRegExp(e.delimiter)?e.delimiter:g.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:g.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:g.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:g.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:g.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:g.strictNullHandling}},Yn=function(r,e){var t=Hn(e);if(r===""||r===null||typeof r>"u")return t.plainObjects?Object.create(null):{};for(var n=typeof r=="string"?Gn(r,t):r,a=t.plainObjects?Object.create(null):{},i=Object.keys(n),l=0;l<i.length;++l){var o=i[l],c=kn(o,n[o],t,typeof r=="string");a=oe.merge(a,c,t)}return t.allowSparse===!0?a:oe.compact(a)},jn=_n,qn=Yn,Xn=ir,Gr={formats:Xn,parse:qn,stringify:jn};const Vr="",kr=!0,Pr=2,Qn=["species","uniforms","particleColor","fieldColor","renderFieldBlend","renderParticlesBlend","mouseRadius","mouseStrength","initialParticlesXY","type","particleSize","particleCount","bgColor","senseDist","senseAng","moveAng","moveDist","dt","friction","rMax","beta","forceFactor","bgLength","numSpecies","blendMode"],Jn=["i","j","l","f","t","I","r","c","k","s","v","x","y","z","J","a","b","d","e","g","h","n","o","p","q","u","L","F","T","Z"],Hr=Object.fromEntries(Qn.map((r,e)=>[r,Jn[e]])),Zn=Object.fromEntries(Object.entries(Hr).map(([r,e])=>[e,r])),Kn=(r,e=Hr)=>(r.split("[").map(n=>n.replace("]","")).filter(n=>isNaN(n)).forEach(n=>{r=r.replaceAll(n,e[n]||n)}),r=r.split("[").map(n=>n.replace("]","")).join(Vr),r),ei=(r,e=Zn)=>(r=r.split(Vr).map(n=>isNaN(n)&&e[n]||n).map((n,a)=>a===0?n:`[${n}]`).join(""),r),ri=r=>{const e=new URL(window.location.href),t=Gr.stringify(r,{encoder:(n,a,i,l)=>a(l==="key"&&kr?Kn(n):typeof n=="number"?Math.round(n*Math.pow(10,Pr))/Math.pow(10,Pr):n,a,i,l)});e.search=t,setTimeout(()=>console.log("URL PARAM LENGTH",e.search.length),100),window.history.replaceState({},"",e)},ti=()=>{const r=new URL(window.location.href);return Gr.parse(r.search,{ignoreQueryPrefix:!0,decoder:(t,n,a,i)=>{const l=n(t,n,a,i),o=Number(l);return i==="key"&&kr?ei(l):Number.isNaN(o)?l:o}})},xe=class extends X{constructor(e){super({particleCount:50,particleSize:5,renderField:"mix(vec4(0.), fieldColor, length(field(UV))/2.)",readOtherParticles:!0,initialParticlesZW:R.RANDOM_UNIT,updateParticles:()=>`
  FOut = Src(I); // current particle
  #define wrap(p) (fract(p+0.5)-0.5)
  vec2 force=vec2(0.); // initialize force vector to 0
  ${xe.instances.map((t,n)=>`// Looping through all particles to compute forces
  for (int y=0; y<particles_${t.name}_size().y; ++y)
  for (int x=0; x<particles_${t.name}_size().x; ++x) {
    if (x==I.x && y==I.y) continue; // Skip self
    vec2 data1 = particles_${t.name}(ivec2(x,y)).xy/(min(worldSize.x,worldSize.y)); // particle to compare with
    vec2 dpos = wrap(data1-(FOut.xy/(min(worldSize.x,worldSize.y)))); // distance vector between particles
    float r = length(dpos); // length of distance vector
    if (r>0.&&r<rMax) {
      float f = 0.;
      if (r<beta) f = r/beta-1.;
      else if (beta<r&&r<1.) f = F[${Math.min(Math.round(n),3)}]*(1.-abs(2.*r-1.-beta)/(1.-beta));
      force += dpos/r*f; // add net force (attraction - repulsion) to the force vector
    }
  }`).join(`
`)}
  force *= rMax*forceFactor;

  FOut.zw *= friction;
  FOut.zw += force*dt;

  // Compute new velocity and position
  FOut.xy = FOut.xy+FOut.zw;
  `,...e,uniforms:{dt:.01,friction:.94,rMax:.2,beta:.01,forceFactor:6,F:Array(4).fill().map(()=>Math.random()*2-1),...e.uniforms||{}}}),xe.instances.push(this)}};let me=xe;Ie(me,"instances",[]);class ni extends X{constructor(e){super({particleCount:1e4,particleSize:1,updateParticles:`
  vec2 dir = vec2(cos(FOut.z), sin(FOut.z));
  mat2 R = rot2(radians(senseAng));
  vec2 sense = senseDist*dir;
  #define F(p) field((FOut.xy+(p))/worldSize)[int(senseChannel)]
  float c=F(sense), r=F(R*sense), l=F(sense*R);
  float rotAng = radians(moveAng);
  if (l>c && c>r) {
      FOut.z -= rotAng;
  } else if (r>c && c>l) {
      FOut.z += rotAng;
  } else if (c<=r && c<=l) {
      FOut.z += sign(hash(ivec3(FOut.xyz*seed)).x-0.5)*rotAng;
  }
  FOut.xy += dir*moveDist;`,...e,uniforms:{senseDist:18,senseAng:6,senseChannel:0,moveAng:45,moveDist:1,...e.uniforms||{}}})}}const xr=Math.sqrt(3),Yr=Ue(4,0,.1),Qe=Math.sqrt(Yr.slice(0,3).reduce((r,e)=>r+e*e,0)),be=ee(3,8),jr=Qe<xr/3?q.ADD:Qe<2*xr/3?q.PREMULTIPLIED:q.SUBTRACT,Le={life:()=>({type:"life",uniforms:{dt:O(.005,.02),friction:O(.7,.99),rMax:O(.05,.5),beta:O(.01,.1),forceFactor:O(.5,8)},particleSize:O(1,5),particleCount:ee(100,1400)}),physarum:()=>({type:"physarum",uniforms:{senseDist:O(1,70),senseAng:O(-8,80),moveAng:O(20,170),moveDist:O(1,30)},particleSize:O(.1,1),particleCount:ee(5e3,8e4)}),shared:()=>({particleColor:Ue(4,0,1/be),fieldColor:Ue(4,0,1/be),renderFieldBlend:jr,renderParticlesBlend:q.ADD,mouseRadius:O(0,.5),mouseStrength:O(-.5,.5),initialParticlesXY:Kr([R.SIN(O(0,1),O(0,.5)),R.CIRCLE(O(0,1)),R.RANDOM_WORLD,R.DOT_GRID(ee(2,20)),R.VERTICLE_LINE,R.HORIZONTAL_LINE,R.VERTICLE_LINES(ee(2,20)),R.HORIZONTAL_LINES(ee(2,20))])})},Pe={bgColor:Yr,bgLength:Qe,numSpecies:be,blendMode:jr,species:Array(be).fill().map(()=>({...Le.shared(),...O()>.5?Le.life():Le.physarum()})),...ti()};ri(Pe);et(Pe.bgColor.join(","));Pe.species.forEach(r=>r.type==="life"?new me({...r,renderParticles:`
    vec2 velocity = particle.zw;
    float angle = atan(velocity.x, velocity.y);
    vec2 XYS = XY;
    XYS = vec2(cos(angle)*XYS.x-sin(angle)*XYS.y, sin(angle)*XYS.x+cos(angle)*XYS.y);          
    XYS *= vec2(1.+length(particle.zw)*5.,1.);
    FOut = mix(vec4(0.), particleColor, smoothstep(1.0, 0.2, length(XYS)));
    `}):new ni({...Pe.sharedProps,...r}));
